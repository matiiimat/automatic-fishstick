<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Library</title>
    <style>
        body {
            background-color: #f2f2f2;
            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            font-size: 18px;
            line-height: 1.5;
            color: #333333;
            text-align: center;
            margin: 0;
            padding: 0;
        }

        h1 {
            font-size: 72px;
            font-weight: 500;
            letter-spacing: -2px;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        p {
            font-size: 24px;
            font-weight: 300;
            margin-top: 0;
            margin-bottom: 40px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .grid-item {
            width: 100%;
            height: auto;
        }
    </style>
</head>

<body>
    <h1>Library</h1>
    <p>Welcome to your online library.</p>

    <!-- Display all NFT with metadata: game
        0xd41d3e25d5b6006b20603006908422d978c5a540 [metadata: Background = LightPink] for address 0x03cc9c887cFFd31bdB4c58444EE54873e0E4ddae -->

    <div id="token-images" class="grid-container"></div>

    <script>
        // Replace the following values with your own:
        const contractAddress = '0xd41d3e25d5b6006b20603006908422d978c5a540';
        const userAddress = '0x03cc9c887cFFd31bdB4c58444EE54873e0E4ddae';

        const ERC721_ABI = [
            {
                "constant": true,
                "inputs": [
                    {
                        "name": "tokenId",
                        "type": "uint256"
                    }
                ],
                "name": "tokenURI",
                "outputs": [
                    {
                        "name": "",
                        "type": "string"
                    }
                ],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [
                    {
                        "name": "owner",
                        "type": "address"
                    }
                ],
                "name": "tokensOfOwner",
                "outputs": [
                    {
                        "name": "",
                        "type": "uint256[]"
                    }
                ],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            }
        ];

        async function fetchTokenMetadata(uri) {
            const response = await fetch(uri);
            return await response.json();
        }

        async function displayERC721TokenImages() {
            if (window.ethereum) {
                try {
                    const web3 = new Web3(window.ethereum);
                    await window.ethereum.request({ method: 'eth_requestAccounts' });
                    const contract = new web3.eth.Contract(ERC721_ABI, contractAddress);
                    const tokenIds = await contract.methods.tokensOfOwner(userAddress).call();

                    for (const tokenId of tokenIds) {
                        const tokenURI = await contract.methods.tokenURI(tokenId).call();
                        const metadata = await fetchTokenMetadata(tokenURI);

                        if (metadata && metadata.description === 'LightPink' && metadata.image) {
                            const img = document.createElement('img');
                            img.src = metadata.image;
                            img.classList.add('grid-item');
                            document.getElementById('token-images').appendChild(img);
                        }
                    }
                } catch (error) {
                    console.error('Error:', error);
                    document.getElementById('token-images').innerText = 'Error retrieving token images';
                }
            } else {
                console.error('Ethereum browser not detected');
                document.getElementById('token-images').innerText = 'Please install an Ethereum browser like MetaMask';
            }
        }

        displayERC721TokenImages();
    </script>


</body>

</html>